<div class="container">
  <div *ngIf="hasAbonnemang()">
    <h3>{{ "adm.abonnemang.productsAndServices" | transloco }}</h3>
    <xp-accordion-table [dataSource]="abonnemang" [columns]="columns" [showHeaderRow]="false">
      <ng-container columns>

        <ng-container matColumnDef="edit">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let elem; let i = dataIndex">
            <button mat-icon-button>
              <mat-icon class="agaretable-icon">create</mat-icon>
            </button>
          </td>
        </ng-container>

        <ng-container matColumnDef="produkt">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let elem">
            {{ "adm.produkt." + elem.produkt | transloco }}
          </td>
        </ng-container>

        <ng-container matColumnDef="nivÃ¥">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let elem">
            {{ "adm.abonnemangTyp." + elem.typ | transloco }}
          </td>
        </ng-container>

        <ng-container matColumnDef="delete">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let elem">
            <button mat-button color="warn" (click)="abonnemangDelete.emit(elem)">
              {{ "xp.common.delete" | transloco }}
            </button>
          </td>
        </ng-container>
      </ng-container>
    </xp-accordion-table>
  </div>

  <div *ngIf="showForm">
    <h3>{{ "adm.abonnemang.addProductsOrServices"| transloco }}</h3>
    <form class="row" [formGroup]="form">
      <span class="col-2 vertical-center">{{ "adm.abonnemang.addProduct"| transloco }}</span>
      <mat-form-field class="col-5">
        <mat-select formControlName="produkt">
          <mat-option *ngFor="let produkt of produkter" [value]="produkt">
            {{ "adm.produkt." + produkt | transloco }}
          </mat-option>
        </mat-select>
        <mat-error>{{ "xp.common.fieldMandatory" | transloco}}</mat-error>
        <mat-label>{{ "adm.abonnemang.chooseProduct" | transloco }}</mat-label>
      </mat-form-field>
      <span class="col-1 vertical-center horizontal-center">{{ "adm.abonnemang.level" | transloco }}</span>
      <mat-form-field class="col-4">
        <mat-select formControlName="typ">
          <mat-option *ngFor="let typ of abonnemangTyper" [value]="typ">
            {{ "adm.abonnemangTyp." + typ | transloco }}
          </mat-option>
        </mat-select>
        <mat-error>{{ "xp.common.fieldMandatory" | transloco}}</mat-error>
        <mat-label>{{ "adm.abonnemang.chooseLevel" | transloco }}</mat-label>
      </mat-form-field>
    </form>
    <div class="actions row">
      <button mat-button *ngIf="hasAbonnemang()" (click)="toggleForm()">{{ "xp.common.cancel" | transloco }}</button>
      <button mat-flat-button color="primary" (click)="submit()" [disabled]="!canSave()">{{ "xp.common.save" | transloco }}</button>
    </div>
  </div>

  <div *ngIf="!showForm">
    <button mat-button (click)="toggleForm()">
      <mat-icon>add</mat-icon>
      {{ "adm.abonnemang.addMoreProductsOrServices" | transloco }}
    </button>
  </div>

</div>
