<div class="row justify-center">
  <div class="col-11">
    <div class="row">
      <div class="form-container col-12 col-md-6 d-flex">
        <h1>{{ "xp.userProfile.emailSettings" | transloco }}</h1>
        <div class="row">
          <form [formGroup]="emailForm" class="d-flex">
            <div class="col-12">
              <mat-form-field>
                <mat-label>{{ "xp.userProfile.email" | transloco }}</mat-label>
                <input type="email" matInput [formControl]="email" placeholder="{{'xp.userProfile.emailExample' | transloco}}">
                <mat-error *ngIf="email.hasError('email') && !email.hasError('required')">
                  {{ "xp.userProfile.giveValidEmail" | transloco }}
                </mat-error>
                <mat-error *ngIf="email.hasError('required')">
                  {{ "xp.common.fieldMandatory" | transloco }}
                </mat-error>
              </mat-form-field>
            </div>
          </form>
        </div>
        <div class="spacer"></div>
        <div class="row button-row">
          <span *ngIf="emailStatus" class="form-status">{{ emailStatus }}</span>
          <button mat-raised-button class="save-button"
                  color="primary"
                  (click)="changeEmail(emailForm.value.email)"
                  [disabled]="!emailForm.valid">
            {{ "xp.common.save" | transloco}}
          </button>
        </div>
    </div>
    <div class="form-container col-12 col-md-6">
        <h1>{{ "xp.userProfile.passwordSettings" | transloco }}</h1>
        <form [formGroup]="passwordForm">
          <!-- Finns fÃ¶r att undvika att chrome sparar currentPassword som username -->
          <input type="text" hidden>

          <div class="row">
            <mat-form-field>
              <mat-label>{{ "xp.userProfile.currentPassword" | transloco }}</mat-label>
              <input matInput [type]="hideCurrent ? 'password' : 'text'" [formControl]="currentPassword" autocomplete="current-password">
              <mat-error *ngIf="currentPassword.hasError('required')">
                {{ "xp.common.fieldMandatory" | transloco }}
              </mat-error>
              <mat-error *ngIf="currentPassword.hasError('wrongPass')">
                {{ "xp.userProfile.wrongPassword" | transloco }}
              </mat-error>
              <button mat-icon-button matSuffix (click)="hideCurrent = !hideCurrent" [attr.aria-label]="'xp.userProfile.showPassword' | transloco" [attr.aria-pressed]="hideCurrent">
                <mat-icon>{{hideCurrent ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
            </mat-form-field>
          </div>
          <div class="row">
            <mat-form-field>
              <mat-label>{{ "xp.userProfile.newPassword" | transloco }} ({{ "xp.userProfile.minimumCharacters" | transloco: { numChars: "16" } | lowercase }})</mat-label>
              <input matInput [type]="hideNew ? 'password' : 'text'" [formControl]="newPassword" autocomplete="new-password">
              <mat-error *ngIf="newPassword.hasError('minlength') && !newPassword.hasError('required')">
                {{ "xp.userProfile.passwordMinimumLength" | transloco: { numChars: "16" } }}
              </mat-error>
              <mat-error *ngIf="newPassword.hasError('required')">
                {{ "xp.common.fieldMandatory" | transloco }}
              </mat-error>
              <button mat-icon-button matSuffix (click)="hideNew = !hideNew" [attr.aria-label]="'xp.userProfile.showPassword' | transloco" [attr.aria-pressed]="hideNew">
                <mat-icon>{{hideNew ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
            </mat-form-field>
          </div>
          <div class="row">
            <mat-form-field>
              <mat-label>{{ "xp.userProfile.confirmNewPassword" | transloco }}</mat-label>
              <input matInput [type]="hideConfirm ? 'password' : 'text'" [formControl]="confirmation" autocomplete="new-password" [errorStateMatcher]="passwordMatcher">
              <mat-error *ngIf="passwordForm.hasError('notSame')">
                {{ "xp.userProfile.passwordsDoNotMatch" | transloco }}
              </mat-error>
              <mat-error *ngIf="confirmation.hasError('required')">
                {{ "xp.common.fieldMandatory" | transloco }}
              </mat-error>
              <button mat-icon-button matSuffix (click)="hideConfirm = !hideConfirm" [attr.aria-label]="'xp.userProfile.showPassword' | transloco" [attr.aria-pressed]="hideConfirm">
                <mat-icon>{{hideConfirm ? 'visibility_off' : 'visibility'}}</mat-icon>
              </button>
            </mat-form-field>
          </div>
        </form>
        <div class="row button-row">
          <span *ngIf="changePasswordStatus" class="form-status">{{ changePasswordStatus }}</span>
          <button mat-raised-button class="save-button" color="primary" (click)="changePassword(passwordForm.value)" [disabled]="!passwordForm.valid">{{ "xp.userProfile.changePassword" | transloco }}</button>
        </div>
      </div>
    </div>
  </div>
</div>
